# Лабораторная работа №4 "Архитектура сети"

### **Задание:**
  1. Разработать и задокументировать адресное пространство для лабораторного стенда.
  2. Настроить ip адреса на каждом активном порту
  3. Настроить каждый VPC в каждом офисе в своем VLAN.
  4. Настроить VLAN/Loopbackup interface управления для сетевых устройств.
  5. Настроить сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано.

### **Решение:**
  1. [Разработаем и задокументируем адресное пространство для лабораторного стенда.](#title1)
  2. [Настроим ip адреса на каждом активном порту.](#title2)
  3. [Настроим каждый VPC в каждом офисе в своем VLAN.](#title3)
  4. [Настроим VLAN/Loopbackup interface управления для сетевых устройств.](#title4)
  5. [Настроим сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано.](#title5)

#### <a id=title1> 1. Разработаем и задокументируем адресное пространство для лабораторного стенда.</a>
  Схема сети:
  
  ![Схема сети](https://github.com/MIranaNightshade/otus-networks/blob/main/lab4/jpeg/%D1%81%D1%85%D0%B5%D0%BC%D0%B0%20%D1%81%D0%B5%D1%82%D0%B8.png) 
  
  
  Будем использовать следующие подсети: 
  Суммарные подсети для управления и loopback итерфейсов 10.5.0.0/21, для линков между роутерами (кроме провайдеров Киторн, Ламас, Триада и линков к провайдерам) 10.7.0.0/21, разделим эти подсети на /24 таким образом,
     чтобы третий октет соотвествовал разным локациям по следующему принципу: 0 - Москва, 1 - Киторн, 2 - Ламас, 3 - Триада, 4 - Лабытнанги, 5 - Чокурдах, 6 - С.Петербург. Для хостов используем подсеть 172.16.0.0/12,
     разобем ее на подсети /24 для хостов в Москве 172.16.0.0/24, 172.17.0.0/24; для хостов в С.Петербурге 172.16.6.0/24, 172.17.6.0/24; для хостов в Чокурдахе 172.16.5.0/24, 172.17.5.0/24. Последний октет для всех
     будет соответствовать порядковому номеру устройства на схеме сети.     
  
  Общая таблица сетей:
  | №| LOCATION | NETWORK MANAGEMENT/LOOPBACK  | ROUTER'S LINKS | HOSTS NETWORKS |
  | --|----------| -------------------------| ---------------| -------------|
  | **0** | Москва  | 10.5.**0**.0/24  | 10.7.**0**.0/24    |172.16.**0**.0/24, 172.17.**0**.0/24 |
  | **1** | Киторн | 10.5.**1**.0/24 |  176.30.**1**.0/24 |  NOT USED |
  | **2** | Ламас | 10.5.**2**.0/24 | 213.30.**2**.0/244 |  NOT USED |
   |**3** | Триада | 10.5.**3**.0/24 | 94.30.**3**.0/24 | NOT USED |
  | **4**  | Лабытнинги | 10.5.**4**.0/24 | 10.7.**4**.0/24 |  NOT USED |
   | **5** | Чокурдах | 10.5.**5**.0/24 | 10.7.**5**.0/24 | 172.16.**5**.0/24, 172.17.**5**.0/24 |  
  | **6** | С.Петербург | 10.5.**6**.0/24 | 10.7.**6**.0/24 |   172.16.**6**.0/24, 172.17.**6**.0/24 |

  Таблица выделенных адресов маршрутизаторов:
  
  | Device | Loopback address |  Port | Address | Network | Direction | 
  | ----- | -----------| ------| ----    |  ---    | --------- | 
  | R12 | 10.5.0.12/32 | e0/0 | 10.7.0.1/30| 10.7.0.0/30| to SW4 |
  | R12 | 10.5.0.12/32 | e0/1 | 10.7.0.5/30|10.7.0.4/30 | to SW5 |
  | R12 | 10.5.0.12/32 | e0/2 | 10.7.0.9/30| 10.7.0.8/30| to R14 |
  | R12 | 10.5.0.12/32 | e0/3 | 10.7.0.13/30| 10.7.0.12/30| to R15 |
  | R13 | 10.5.0.13/32 | e0/0 |10.7.0.17/30 | 10.7.0.16/30| to R15 |
  | R13 | 10.5.0.13/32 | e0/1 |10.7.0.21/30 |10.7.0.20/30 | to SW4 |
  | R13 | 10.5.0.13/32 | e0/2 | 10.7.0.25/30| 10.7.0.24/30 | to R15|
  | R13 | 10.5.0.13/32 | e0/3 | 10.7.0.29/30| 10.7.0.28/30 | to R14|
  | R14 | 10.5.0.14/32 |e0/0 | 10.7.0.10/30| 10.7.0.8/30| to R12 |
  | R14 | 10.5.0.14/32 | e0/1 | 10.7.0.30/30 | 10.7.0.28/30| to R13 | 
  | R14 | 10.5.0.14/32 | e0/2 | 176.30.1.2/30|176.30.1.0/30| to R22 |
  | R14 | 10.5.0.14/32 | e0/3 | 10.7.0.33/30 | 10.7.0.32/30 | to R19 |
  | R15 | 10.5.0.15/32 | e0/0 | 10.7.0.26/30 | 10.7.0.24/30| to R13 |  
  | R15 | 10.5.0.15/32 | e0/1| 10.7.0.14/30| 10.7.0.12/30| to R12 | 
  | R15 | 10.5.0.15/32 | e0/2 | 213.30.2.2/30| 213.30.2.0/30| to R21|
  | R15 | 10.5.0.15/32 | e0/3 | 10.7.0.37/30 | 10.7.0.36/30| to R20 |
  | R16 | 10.5.6.16/32 | e0/1 | 10.7.0.41/30 | 10.7.0.40/30 | to R18 | 
  | R16 | 10.5.6.16/32 | e0/2 | 10.7.0.45/30 | 10.7.0.44/30 | to R17 | 
  | R16 | 10.5.6.16/32 | e0/3 | 10.7.0.49/30 | 10.7.0.48/30 | to R32 |
  | R17 | 10.5.6.17/32 | e0/1 | 10.7.0.53/30 | 10.7.0.52/30 | to R18 |  
  | R17 | 10.5.6.17/32 | e0/2 | 10.7.0.46/30 | 10.7.0.44/30 | to R16 | 
  | R18 | 10.5.6.18/32 | e0/0 | 10.7.0.42/30 | 10.7.0.40/30 | to R16 |
  | R18 | 10.5.6.18/32 | e0/1 | 10.7.0.54/30 | 10.7.0.52/30 | to R17 |
  | R18 | 10.5.6.18/32 | e0/2 | 94.30.3.14/30| 94.30.3.12/30| to R24|
  | R18 | 10.5.6.18/32 | e0/3 | 94.30.3.34/30| 94.30.3.32/30| to R26 |
  | R19 | 10.5.0.19/32 | e0/0 | 10.7.0.34/30 | 10.7.0.32/30 | to R14 |
  | R20 | 10.5.0.20/32 | e0/0 | 10.7.0.38/30 |10.7.0.36/30  | to R15 | 
  | R21 | 10.5.2.21/32 | e0/0 | 213.30.2.1/30 | 213.30.2.0/30 | to R15 |
  | R21 | 10.5.2.21/32 | e0/1 | 213.30.2.5/30 | 213.30.2.4/30 | to R22  |
  | R21 | 10.5.2.21/32 | e0/2 | 213.30.2.9/30 | 213.30.2.8/30 | to R24 | 
  | R22 | 10.5.1.22/32 | e0/0 | 176.30.1.1/30 | 176.30.1.0/30 | to R14| 
  | R22 | 10.5.1.22/32 | e0/1 | 213.30.2.6/30 | 213.30.2.4/30 | to R21 |
  | R22 | 10.5.1.22/32 | e0/2 | 176.30.1.5/30 |176.30.1.4/30| to R23 |
  | R23 | 10.5.3.23/32 | e0/0 | 176.30.1.6/30 | 176.30.1.4/30| to R22  |
  | R23 | 10.5.3.23/32 | e0/1 | 94.30.3.1/30 | 94.30.3.0/30 | to R25 | 
  | R23 | 10.5.3.23/32 | e0/2 | 94.30.3.5/30 | 94.30.3.4/30 | to R24  |
  | R24 | 10.5.3.24/32 | e0/0 | 213.30.2.10/30 | 213.30.2.8/30 | to R21 | 
  | R24 | 10.5.3.24/32 | e0/1 | 94.30.3.9/30 | 94.30.3.8/30 | to R26 | 
  | R24 | 10.5.3.24/32 | e0/2 | 94.30.3.6/30 | 94.30.3.4/30 | to R23 |
  | R24 | 10.5.3.24/32 | e0/3 | 94.30.3.13/30 | 94.30.3.12/30 | to R18 |
  | R25 | 10.5.3.25/32 | e0/0 | 94.30.3.2/30 | 94.30.3.0/30 | to R23 | 
  | R25 | 10.5.3.25/32 | e0/1 | 94.30.3.17/30 | 94.30.3.16/30 | to R27 | 
  | R25 | 10.5.3.25/32 | e0/2 | 94.30.3.21/30 | 94.30.3.20/30 | to R26  |
  | R25 | 10.5.3.25/32 | e0/3 | 94.30.3.25/30 | 94.30.3.24/30 | to R28 | 
  | R26 | 10.5.3.26/32 | e0/0 | 94.30.3.10/30 | 94.30.3.8/30 | to R24 |  
  | R26 | 10.5.3.26/32 | e0/1 | 94.30.3.29/30 | 94.30.3.28/30 | to R28 | 
  | R26 | 10.5.3.26/32 | e0/2 | 94.30.3.22/30 | 94.30.3.20/30 | to R25  |
  | R26 | 10.5.3.26/32 | e0/3 | 94.30.3.33/30 | 94.30.3.32/30 | to R18 |
  | R27 | 10.5.4.27/32 | e0/0 |94.30.3.18/30 | 94.30.3.16/30 | to R25 | 
  | R28 | 10.5.5.28/32 | e0/0 | 94.30.3.30/30 | 94.30.3.28/30 | to R26 | 
  | R28 | 10.5.5.28/32 | e0/1 | 94.30.3.26/30 | 94.30.3.24/30 | to R25 |
  | R32 | 10.5.6.32/32 | e0/0 | 10.7.0.50/30 | 10.7.0.48/30 | to R16 | 
  | SW4 | -            | e1/0 | 10.7.0.2/30| 10.7.0.0/30| to R12|
  | SW4 | -            | e1/1 | 10.7.0.22/30 | 10.7.0.20/30| to R13 |
  | SW5 | -            | e1/0 | 10.7.0.18/30 | 10.7.0.16/30 | to R13 |
  | SW5 | -            | e1/1 | 10.7.0.6/30 | 10.7.0.4/30 | to R12 |

  Таблица адресов для управления коммутаторами:
  
 | device | management IP | management network | management vlan |
 |--------| ----------| ------------|-----|
 |SW2 | 10.5.0.2/24 | 10.5.0.0/24 | 100 |
 |SW3 | 10.5.0.3/24 | 10.5.0.0/24 | 100 | 
 |SW4 | 10.5.0.4/24 | 10.5.0.0/24 | 100 |
 |SW5 | 10.5.0.5/24 | 10.5.0.0/24 | 100 | 
 |SW9 | 10.5.6.9/24 | 10.5.6.0/24 | 100 |
 |SW10| 10.5.6.10/24 | 10.5.6.0/24 | 100 | 
 |SW29| 10.5.5.29/24 |10.5.5.0/24 | 100|
  
 #### <a id=title1>2. Настроим ip адреса на каждом активном порту.</a>

  Пример настройки ip на порту маршрутизатора (R15): 
  
  ```
  interface Ethernet0/0
   ip address 10.7.0.26 255.255.255.252
  end
  ```

  Пример настройки ip на порту L3 коммутатора (SW5): 

  ```
  interface Ethernet1/0
   no switchport
   ip address 10.7.0.18 255.255.255.252
   duplex auto
  end
  ```
#### <a id=title3>3. Настроим каждый VPC в каждом офисе в своем VLAN.</a> 

  Таблица IP адресов для VPC:
  
  | VPC | Location | IP address | network | gateway | vlan | 
  |------| ----- | ----| -- | ---- | --- |
  | VPC1 | Москва | 172.16.0.1/24 | 172.16.0.0/24 | 172.16.0.254 | 10 |
  | VPC7 | Москва |  172.17.0.7/24 |  172.17.0.0/24 | 172.17.0.254 | 20 |
  | VPC8 | C.-Петербург | 172.16.6.8/24 | 172.16.6.0/24 | 172.17.6.254| 10 |  
  | VPC33| C.-Петербург | 172.17.6.33/24 | 172.17.6.0/24 | 172.17.6.254| 20 |
  | VPC30| Чокурдах | 172.16.5.30/24 | 172.16.5.0/24 | 172.16.5.254| 10 |
  |VPC31 | Чокурдах | 172.17.5.31/24 | 172.17.5.0/24| 172.17.5.254| 20 |

#### <a id=title4>4. Настроим VLAN/Loopbackup interface управления для сетевых устройств</a>

  Таблица loopback интерфейсов роутеров:

  | Device |	Loopback address|
  |------ | ------|
  |R12	 |10.5.0.12/32 |
   |R13 |	10.5.0.13/32 |
   |R14	 |10.5.0.14/32 |
   |R15	 |10.5.0.15/32 |
   |R16	 |10.5.6.16/32 |
   |R17	 |10.5.6.17/32 |
   |R18  | 10.5.6.18/32 |
   |R19	 |10.5.0.19/32 |
   |R20 |	10.5.0.20/32 |
   |R21	 |10.5.2.21/32 |
   |R22	 |10.5.1.22/32 |
   |R23	 |10.5.3.23/32 |
   |R24	 |10.5.3.24/32 |
   |R25	 |10.5.3.25/32 |
   |R26 |10.5.3.26/32 |
   |R27	 |10.5.4.27/32 |
   |R28	 |10.5.5.28/32 |
   |R32	 |10.5.6.32/32 |
  
   Пример настройки Loopback (R15):
   
    ```
    interface Loopback0
     ip address 10.5.0.15 255.255.255.0
    end
  


    Таблица vlan/IP адресов управления для коммутаторов: 
  
    | device | IP address | VLAN | gateway | 
    | ------|---------| ------ | ----- |
    | SW2 | 10.5.0.2/24 | 100 | 10.5.0.254 | 
    |SW3 | 10.5.0.3/24 | 100 | 10.5.0.254 | 
    |SW4 | 10.5.0.4/24 | 100 | N/A |
    |SW5 |  10.5.0.5/24 | 100 | N/A |  
    | SW9 | 10.5.6.9/24 | 100 | 10.5.6.254 | 
    |SW10 | 10.5.6.10/24 | 100 | 10.5.6.254 | 
    |SW29 |  10.5.5.29/24 | 100 | 10.5.5.254 | 

  
    Пример настройки management vlan на коммутаторах (SW5):
  
  
    ```
    interface Vlan100
     ip address 10.5.0.5 255.255.255.0
     vrrp 1 ip 10.5.0.254
     vrrp 1 priority 254
    end
  
 

   



  

  

  


  
